# SoilFER Technical Manual for Sampling Design

The *SoilFER Technical Manual for Sampling Design* provides general guidance on soil sampling design methodologies to ensure precision, reproducibility, and reliability in the collection of soil samples for digital soil mapping and monitoring.

## Brief Introduction

This folder contains materials to produce a Soil Sampling Design for the SoilFER Project, using a study case in Zambia as an example. The design applies a three-stage hierarchical hybrid method incorporating both probability and non-probability sampling for soil mapping and monitoring within the SoilFER framework.

The first hierarchical level selects the primary sampling units using a spatial coverage sampling method based on environmental covariates (model-based). The second and third hierarchical levels select the secondary and tertiary sampling units using simple random sampling and stratified random sampling, respectively, both without replacement (design-based). This implementation standardizes soil sampling methodologies across the various countries involved in the project.

## Folder Content - Rasters

The environmental covariates for this example can be downloaded from the [raster folder](./data/rasters).

### Environmental Covariates - Climate, Remote Sensing, Land cover, and Topography

These covariates represent critical environmental factors influencing soil and landscape processes. Climate includes variables such as temperature, precipitation, and evapotranspiration. Remote sensing provides data on vegetation indices, surface temperature, and albedo. Land cover offers insights into vegetation and land use patterns, while topography encompasses elevation, slope, curvature, and terrain indices, all of which are essential for understanding spatial variability.

The file named **`covs_zam_clipped.tif`** contains the environmental variables retrieved from Google Earth Engine using the code in `gee.txt`. There are two ways to retrieve these variables:
1. By uploading data for the entire country using its ISO Alpha-3 code (e.g., `var ISO = ['ZMB'];`).
2. By using a shapefile with the country boundaries (e.g., `var shapefile = ee.FeatureCollection('projects/ee-soilfer/assets/your_shapefile');`).

### Environmental Covariates - Soil Climate

Soil climate refers to the Normalized Soil Moisture (NSM) factor, which relates to soil water content, precipitation, and evapotranspiration. These factors are essential for assessing soil moisture regimes, soil water availability, and soil-climate interactions.

Environmental variables related to soil climate can be generated using the Google Earth Engine (GEE)[gee_climate_vars](./scripts/GEE) and R code [climate_vars.R](./scripts). 
First of all, create a GEE account and upload the GEE code. Select the desired years, run the code, and upload the resulting files into the [raster folder](./data/rasters). Next, open the R code file [climate_vars.R](./scripts). Follow the provided instructions to calculate the traditional soil climate simulation model known as the [Newhall Simulation Model](https://github.com/ncss-tech/jNSMR).

The file named **`newhall_zam_clipped.tif`** contains these variables, so there is no need to generate them here.

### Land Use - Crops

Land cover data at 10 m or 100 m resolution can be retrieved using the [Hand-in-Hand Geospatial Platform](https://data.apps.fao.org/?lang=en) and Copernicus products via the [`gee.txt` code](./data/rasters).

The crop layer consists of a single raster delineating the location of crops in the region of interest. This layer is named **`cropland_clipped_zmb_v1_epsg_3857.tif`**.

## Important Notes

- The three raster files (**cropland_clipped_zmb_v1_epsg_3857.tif**, **covs_zam_clipped.tif**, and **newhall_zam_clipped.tif**) **MUST** be stored in the `./data/rasters` folder. Alternatively, update the corresponding file paths in the R script.

- The R code is available in both `R` and `Rmd` files within the `/scripts` folder.

- All results generated by the scripts will be stored in the `/data/results` folder.
